!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r():"function"==typeof define&&define.amd?define(r):e.js2xlsx=r()}(this,function(){"use strict";const a=require("xlsx"),o=require("glob"),s=require("fs"),f=require("path"),c=f.normalize(__dirname);return{js2excel:function({filePath:e,fileName:t}){var n=[];o.sync(f.join(c,`/${e}/zh/*.js`)).forEach(e=>{e=e.slice(e.lastIndexOf("/")+1,e.lastIndexOf("."));n.push(e)});var r=o.sync(f.join(c,`/${e}/**/*.js`)),i={};n.forEach(t=>{var s=[];r.forEach(function(e,r){var n,i,o;e.slice(e.lastIndexOf("/")+1,e.lastIndexOf("."))==t&&(s=s.concat((n=e,i=require(n),o=[],Object.keys(i).forEach(e=>{var r=n.split("/")[n.split("/").length-2],t={};t.key=e,t[r]=i[e],o.push(t)}),o)))}),i[t]=s}),function(o){var s={};Object.keys(o).forEach((e,r)=>{var t=[],n=[];o[e].forEach(r=>{o[e].forEach(e=>{r.key===e.key&&(r=Object.assign({},r,e))}),t.push(r)}),t.forEach(r=>{var t=!1;n.forEach(e=>{r.key==e.key&&(t=!0)}),t||n.push(r)});var i=a.utils.json_to_sheet(n);s[e]=i});var e={SheetNames:n,Sheets:Object.assign({},s)};var r=`/${t}`;a.writeFile(e,f.join(c,r))}(i)},excel2js:function({filePath:o,fileName:e}){var r,e=a.readFile(f.join(c,`/${e}`));(r=e).SheetNames.forEach(t=>{var i={},e=r.Sheets[t];i[t]=a.utils.sheet_to_json(e),Object.keys(i).forEach(e=>{Object.keys(i[e][0]).filter(function(e){return"key"!=e}).forEach(function(r){var n={};i[e].forEach(e=>{n[e.key]=e[r]}),s.mkdir(f.join(c,`/${o}/${r}/`),e=>{}),s.open(f.join(c,`/${o}/${r}/${t}.js`),"w",function(e,r){var t=Buffer.from("module.exports = "+JSON.stringify(n,null,4));s.write(r,t,0,t.length,0,function(e,r,t){})})})})})}}});

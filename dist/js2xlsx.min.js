!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.js2xlsx=t()}(this,function(){"use strict";const a=require("xlsx"),o=require("glob"),s=require("fs"),f=require("path"),c=f.normalize(__dirname);return{js2excel:function({filePath:e,fileName:n}){var r=[];o.sync(f.join(c,`/${e}/zh/*.js`)).forEach(e=>{e=e.slice(e.lastIndexOf("/")+1,e.lastIndexOf("."));r.push(e)});var t=o.sync(f.join(c,`/${e}/**/*.js`)),i={};r.forEach(n=>{var s=[];t.forEach(function(e,t){var r,i,o;e.slice(e.lastIndexOf("/")+1,e.lastIndexOf("."))==n&&(s=s.concat((r=e,i=require(r),o=[],Object.keys(i).forEach(e=>{var t=r.split("/")[r.split("/").length-2],n={};n.key=e,n[t]=i[e],o.push(n)}),o)))}),i[n]=s}),function(o){var s={};Object.keys(o).forEach((e,t)=>{var n=[],r=[];o[e].forEach(t=>{o[e].forEach(e=>{t.key===e.key&&(t=Object.assign({},t,e))}),n.push(t)}),n.forEach(t=>{var n=!1;r.forEach(e=>{t.key==e.key&&(n=!0)}),n||r.push(t)});var i=a.utils.json_to_sheet(r);s[e]=i});var e={SheetNames:r,Sheets:Object.assign({},s)};var t=`/${n}`;a.writeFile(e,f.join(c,t))}(i)},excel2js:function({filePath:o,fileName:e}){var t,e=a.readFile(f.join(c,`/${e}`));(t=e).SheetNames.forEach(n=>{var i={},e=t.Sheets[n];i[n]=a.utils.sheet_to_json(e),Object.keys(i).forEach(e=>{Object.keys(i[e][0]).filter(function(e){return"key"!=e}).forEach(function(t){var r={};i[e].forEach(e=>{r[e.key]=e[t]}),s.mkdir(f.join(c,`/${o}/${t}/`),e=>{}),s.open(f.join(c,`/${o}/${t}/${n}.js`),"w",function(e,t){var n=new Buffer("module.exports = "+JSON.stringify(r,null,4));s.write(t,n,0,n.length,0,function(e,t,n){})})})})})}}});
